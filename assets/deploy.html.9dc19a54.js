import{r as p,o as c,a as l,b as n,d as a,w as r,F as i,e as s,c as t}from"./app.934a939c.js";import{_ as u}from"./plugin-vue_export-helper.21dcd24c.js";const k={},b=n("h1",{id:"\u5FEB\u901F\u90E8\u7F72",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u5FEB\u901F\u90E8\u7F72","aria-hidden":"true"},"#"),s(" \u5FEB\u901F\u90E8\u7F72")],-1),m={class:"custom-container tip"},d=n("p",{class:"custom-container-title"},"TIP",-1),h=s("\u5728\u5F00\u59CB\u4E4B\u524D\uFF0C\u8BF7\u5148\u9605\u8BFB"),y=s(" Anni \u7B80\u4ECB"),_=s("\u3002"),g=n("h2",{id:"\u521B\u5EFA\u5143\u6570\u636E\u4ED3\u5E93",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u521B\u5EFA\u5143\u6570\u636E\u4ED3\u5E93","aria-hidden":"true"},"#"),s(" \u521B\u5EFA\u5143\u6570\u636E\u4ED3\u5E93")],-1),v=n("p",null,"\u5143\u6570\u636E\u4ED3\u5E93\u672C\u8D28\u4E0A\u662F\u4E00\u4E2A Git \u4ED3\u5E93\uFF0C\u53EF\u4EE5\u5B58\u653E\u5728\u4EFB\u610F\u652F\u6301 Git \u7684\u6258\u7BA1\u5E73\u53F0\u3002\u6211\u4EEC\u63A8\u8350\u4F7F\u7528 GitHub \u3002",-1),f=s("\u6700\u7B80\u5355\u7684\u65B9\u5F0F\u662F\u76F4\u63A5 Fork "),x={href:"https://github.com/ProjectAnni/repo",target:"_blank",rel:"noopener noreferrer"},q=s("\u5B98\u65B9\u7684\u5143\u6570\u636E\u4ED3\u5E93"),A=s(" \uFF0C\u4E4B\u540E\u4FEE\u6539 "),P=n("code",null,"repo.toml",-1),w=s(" \u4E2D\u7684\u90E8\u5206\u4FE1\u606F\u5373\u53EF\u3002"),D=s("\u4E5F\u53EF\u4EE5\u9009\u62E9\u81EA\u5DF1\u91CD\u65B0\u521B\u5EFA\u5143\u6570\u636E\u4ED3\u5E93\uFF0C\u683C\u5F0F\u53EF\u53C2\u8003\u5B98\u65B9\u5143\u6570\u636E\u4ED3\u5E93\u3002\u8BE6\u7EC6\u7684 Anni \u5143\u6570\u636E\u4ED3\u5E93\u6807\u51C6\u53EF\u53C2\u8003"),S={href:"https://book.anni.rs/02.metadata-repository/00.readme.html",target:"_blank",rel:"noopener noreferrer"},R=s("book \u7684\u76F8\u5173\u7AE0\u8282"),j=s("\u3002"),E=t(`<h2 id="\u90E8\u7F72-annil" tabindex="-1"><a class="header-anchor" href="#\u90E8\u7F72-annil" aria-hidden="true">#</a> \u90E8\u7F72 annil</h2><p>\u6211\u4EEC\u63A8\u8350\u901A\u8FC7 Docker \u90E8\u7F72 annil \u670D\u52A1\uFF0C\u53C2\u8003\u7684 <code>docker-compose.yml</code> \u5982\u4E0B\uFF1A</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&#39;3&#39;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">annil</span><span class="token punctuation">:</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> annil
    <span class="token key atrule">image</span><span class="token punctuation">:</span> ghcr.io/projectanni/annil<span class="token punctuation">:</span>latest
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 8081<span class="token punctuation">:</span>80/tcp
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./data<span class="token punctuation">:</span>/app/data
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> unless<span class="token punctuation">-</span>stopped
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>\u8FD0\u884C <code>docker-compose up -d</code> \u4E4B\u540E\uFF0C\u6211\u4EEC\u9700\u8981\u4FEE\u6539\u4F4D\u4E8E <code>config/config.toml</code> \u7684 <code>annil</code> \u7684\u914D\u7F6E\u6587\u4EF6\uFF1A</p><div class="language-toml ext-toml line-numbers-mode"><pre class="language-toml"><code><span class="token punctuation">[</span><span class="token table class-name">server</span><span class="token punctuation">]</span>
<span class="token key property">name</span> <span class="token punctuation">=</span> <span class="token string">&quot;My Anni Library&quot;</span>
<span class="token key property">listen</span> <span class="token punctuation">=</span> <span class="token string">&quot;0.0.0.0:80&quot;</span>

<span class="token key property">hmac-key</span> <span class="token punctuation">=</span> <span class="token string">&quot;d31d03ba-8fde-4605-999e-b281be766141&quot;</span> <span class="token comment"># \u968F\u673A\u751F\u6210\uFF0C\u4E0D\u7528\u4FEE\u6539\uFF0C\u4E0B\u540C</span>
<span class="token key property">share-key</span> <span class="token punctuation">=</span> <span class="token string">&quot;5dea211d-da50-44b2-8564-84fe99731fa5&quot;</span>
<span class="token key property">share-key-id</span> <span class="token punctuation">=</span> <span class="token string">&quot;22bc0d6b-e16f-4959-9f37-b6ebcb7b2f76&quot;</span>
<span class="token key property">admin-token</span> <span class="token punctuation">=</span> <span class="token string">&quot;c51788e7-1203-4957-b342-7ead5a4919b4&quot;</span>

<span class="token punctuation">[</span><span class="token table class-name">backends.default</span><span class="token punctuation">]</span> <span class="token comment"># \u6307\u5B9A\u97F3\u9891\u540E\u7AEF\uFF0C\u8FD9\u91CC\u6211\u4EEC\u4F7F\u7528\u6587\u4EF6\u540E\u7AEF</span>
<span class="token key property">enable</span> <span class="token punctuation">=</span> <span class="token boolean">true</span>
<span class="token key property">type</span> <span class="token punctuation">=</span> <span class="token string">&quot;file&quot;</span>
<span class="token key property">root</span> <span class="token punctuation">=</span> <span class="token string">&quot;/library&quot;</span>
<span class="token key property">strict</span> <span class="token punctuation">=</span> <span class="token boolean">true</span>
<span class="token key property">layers</span> <span class="token punctuation">=</span> <span class="token number">2</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>\u914D\u7F6E\u6587\u4EF6\u4FEE\u6539\u540E\u9700\u8981\u91CD\u542F Docker \u5BB9\u5668\u3002</p><h2 id="\u90E8\u7F72-anniv" tabindex="-1"><a class="header-anchor" href="#\u90E8\u7F72-anniv" aria-hidden="true">#</a> \u90E8\u7F72 anniv</h2><p>\u6211\u4EEC\u540C\u6837\u63A8\u8350\u4F7F\u7528 Docker \u90E8\u7F72 anniv \uFF0C\u53C2\u8003\u7684 <code>docker-compose.yml</code> \u5982\u4E0B\uFF1A</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&#39;3&#39;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">anniv</span><span class="token punctuation">:</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> anniv
    <span class="token key atrule">image</span><span class="token punctuation">:</span> ghcr.io/projectanni/anniv<span class="token punctuation">-</span>go<span class="token punctuation">:</span>latest
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 8080<span class="token punctuation">:</span>80/tcp
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./config<span class="token punctuation">:</span>/app/config
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> CONF=/app/config/config.yml
      <span class="token punctuation">-</span> DB_VENDOR=postgres
      <span class="token punctuation">-</span> DB_PATH=postgres<span class="token punctuation">:</span>//anni<span class="token punctuation">:</span>changetoyourdbpasswd@db<span class="token punctuation">:</span>5432/anniv
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> db
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> unless<span class="token punctuation">-</span>stopped
  <span class="token key atrule">db</span><span class="token punctuation">:</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> anniv<span class="token punctuation">-</span>postgres
    <span class="token key atrule">image</span><span class="token punctuation">:</span> postgres<span class="token punctuation">:</span><span class="token number">14.2</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> POSTGRES_USER=anni
      <span class="token punctuation">-</span> POSTGRES_PASSWORD=changetoyourdbpasswd
      <span class="token punctuation">-</span> POSTGRES_DB=anniv
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./db<span class="token punctuation">-</span>data<span class="token punctuation">:</span>/var/lib/postgresql/data
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> unless<span class="token punctuation">-</span>stopped
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>\u7B2C\u4E00\u6B21\u542F\u52A8\u540E\uFF0C\u6211\u4EEC\u540C\u6837\u9700\u8981\u4FEE\u6539 <code>anniv</code> \u7684\u914D\u7F6E\u6587\u4EF6\uFF1A</p><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">site_name</span><span class="token punctuation">:</span> Project Anni
<span class="token key atrule">description</span><span class="token punctuation">:</span> Project Anni Production Site
<span class="token key atrule">listen</span><span class="token punctuation">:</span> 0.0.0.0<span class="token punctuation">:</span><span class="token number">80</span>
<span class="token key atrule">enforce_2fa</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
<span class="token key atrule">headers</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token key atrule">trusted_proxies</span><span class="token punctuation">:</span>
<span class="token punctuation">-</span> 127.0.0.1/32
<span class="token key atrule">repo_url</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/ProjectAnni/repo.git <span class="token comment"># \u4FEE\u6539\u4E3A\u81EA\u5DF1\u7684\u5143\u6570\u636E\u4ED3\u5E93\u5730\u5740</span>
<span class="token key atrule">require_invite</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># \u6CE8\u518C\u662F\u5426\u9700\u8981\u9080\u8BF7\u7801</span>
<span class="token key atrule">invite_code</span><span class="token punctuation">:</span> xxxxxx <span class="token comment"># \u9080\u8BF7\u7801</span>
<span class="token key atrule">annil_token</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># \u4E3A\u6BCF\u4E2A\u7528\u6237\u9ED8\u8BA4\u914D\u7F6E\u7684\u97F3\u9891\u4ED3\u5E93</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> Default token
    <span class="token key atrule">url</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//xxxxxx <span class="token comment"># \u4FEE\u6539\u4E3A\u81EA\u5DF1 annil \u7684 URL</span>
    <span class="token key atrule">allow_share</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># \u662F\u5426\u4E3A\u8FD9\u4E2A\u97F3\u9891\u4ED3\u5E93\u542F\u7528\u5206\u4EAB\u529F\u80FD</span>
    <span class="token key atrule">credential</span><span class="token punctuation">:</span> xxxx <span class="token comment"># \u4FEE\u6539\u4E3A annil \u914D\u7F6E\u6587\u4EF6\u4E2D\u7684</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>\u914D\u7F6E\u6587\u4EF6\u4FEE\u6539\u540E\u9700\u8981\u91CD\u542F Docker \u5BB9\u5668\u3002</p><h2 id="\u6574\u7406\u97F3\u9891\u8D44\u6E90" tabindex="-1"><a class="header-anchor" href="#\u6574\u7406\u97F3\u9891\u8D44\u6E90" aria-hidden="true">#</a> \u6574\u7406\u97F3\u9891\u8D44\u6E90</h2><h3 id="\u5B89\u88C5-anni-cli" tabindex="-1"><a class="header-anchor" href="#\u5B89\u88C5-anni-cli" aria-hidden="true">#</a> \u5B89\u88C5 anni-cli</h3>`,14),O=s("\u4ECE "),G={href:"https://github.com/ProjectAnni/anni/actions/workflows/build.yaml",target:"_blank",rel:"noopener noreferrer"},T=s("GitHub Actions"),W=s(" \u4E2D\u4E0B\u8F7D\u64CD\u4F5C\u7CFB\u7EDF\u5BF9\u5E94\u7684 anni \u4E8C\u8FDB\u5236\uFF0C\u89E3\u538B anni \u53EF\u6267\u884C\u6587\u4EF6\u5E76\u52A0\u5165 PATH \u53D8\u91CF\u3002"),B=t(`<h3 id="\u521B\u5EFA-anni-workspace" tabindex="-1"><a class="header-anchor" href="#\u521B\u5EFA-anni-workspace" aria-hidden="true">#</a> \u521B\u5EFA Anni Workspace</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u5207\u6362\u5230\u5B58\u653E Workspace \u7684\u76EE\u5F55</span>
<span class="token function">mkdir</span> AnniWorkspace
<span class="token builtin class-name">cd</span> AnniWorkspace
anni ws init <span class="token builtin class-name">.</span>
<span class="token builtin class-name">cd</span> .anni
<span class="token comment"># \u514B\u9686\u81EA\u5DF1\u7684\u5143\u6570\u636E\u4ED3\u5E93\u5230 .anni/repo \u4E0B</span>
<span class="token function">git</span> clone https://github.com/ProjectAnni/repo.git repo
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>\u521B\u5EFA <code>.anni/config.toml</code>:</p><div class="language-toml ext-toml line-numbers-mode"><pre class="language-toml"><code><span class="token punctuation">[</span><span class="token table class-name">workspace</span><span class="token punctuation">]</span>
<span class="token key property">publish-to</span> <span class="token punctuation">=</span> <span class="token string">&quot;default&quot;</span>

<span class="token punctuation">[</span><span class="token table class-name">library.default</span><span class="token punctuation">]</span>
<span class="token key property">path</span> <span class="token punctuation">=</span> <span class="token string">&quot;/path/to/publish/path&quot;</span> <span class="token comment"># \u586B\u5199\u97F3\u9891\u6587\u4EF6\u53D1\u5E03\u7684\u76EE\u5F55</span>
<span class="token key property">layers</span> <span class="token punctuation">=</span> <span class="token number">2</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="\u4F7F\u7528-anni-workspace-gui-\u6574\u7406\u97F3\u9891\u8D44\u6E90" tabindex="-1"><a class="header-anchor" href="#\u4F7F\u7528-anni-workspace-gui-\u6574\u7406\u97F3\u9891\u8D44\u6E90" aria-hidden="true">#</a> \u4F7F\u7528 anni-workspace-gui \u6574\u7406\u97F3\u9891\u8D44\u6E90</h3><p>TODO</p><h3 id="\u53D1\u5E03\u5143\u6570\u636E\u53CA\u97F3\u9891\u8D44\u6E90" tabindex="-1"><a class="header-anchor" href="#\u53D1\u5E03\u5143\u6570\u636E\u53CA\u97F3\u9891\u8D44\u6E90" aria-hidden="true">#</a> \u53D1\u5E03\u5143\u6570\u636E\u53CA\u97F3\u9891\u8D44\u6E90</h3><p>\u5728\u4F7F\u7528 Workspace \u4E2D\u53D1\u5E03\u4E13\u8F91\u540E\uFF0C\u5C06 <code>$WORKSPACE_DIR/.anni/repo</code> Git \u4ED3\u5E93\u4E2D\u7684\u53D8\u66F4\u63D0\u4EA4\u5E76\u63A8\u9001\u5230\u8FDC\u7AEF\u4ED3\u5E93\uFF0C\u5E76\u5C06\u97F3\u9891\u6587\u4EF6\u53D1\u5E03\u76EE\u5F55\u4E2D\u7684\u6587\u4EF6\u62F7\u8D1D\u5230 annil \u97F3\u9891\u540E\u7AEF\u76EE\u5F55\u3002</p><p>\u5B8C\u6210\u540E\uFF0C\u91CD\u542F anniv \u53CA annil \u670D\u52A1\u3002</p>`,9);function L(N,V){const o=p("RouterLink"),e=p("ExternalLinkIcon");return c(),l(i,null,[b,n("div",m,[d,n("p",null,[h,a(o,{to:"/guide/intro.html"},{default:r(()=>[y]),_:1}),_])]),g,v,n("p",null,[f,n("a",x,[q,a(e)]),A,P,w]),n("p",null,[D,n("a",S,[R,a(e)]),j]),E,n("p",null,[O,n("a",G,[T,a(e)]),W]),B],64)}var H=u(k,[["render",L]]);export{H as default};
